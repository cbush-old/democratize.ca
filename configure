#!/usr/bin/env php
<?php

// 5.2 compatibility
$DIR = dirname(__FILE__);

include $DIR."/config.php";

foreach(array("{$DIR}/public","{$DIR}/public/api") as $path){

  $htaccess = file_get_contents("{$path}/.htaccess");
  $htaccess = preg_replace("/ErrorDocument.*\n/","",$htaccess);

  static $errors = array(400,404,405,500,503);

  foreach($errors as $e)
    $htaccess .= "ErrorDocument {$e} ".PUBLIC_ROOT."/error.php\n";
    
  file_put_contents("{$path}/.htaccess", $htaccess);

}

die(str_replace($DIR."/","",__FILE__.": success\n"));
